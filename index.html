<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Economics MCQ Practice â€“ CUET | DSE | JNU | UOH</title>

  <!-- Tailwind + Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { poppins: ['Poppins', 'sans-serif'] },
          colors: { primary: '#0ea5a4', muted: '#6b7280' }
        }
      }
    }
  </script>

  <!-- React + Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="bg-white text-gray-800 font-poppins">
  <div id="root" class="min-h-screen flex items-center justify-center p-4"></div>

  <script type="text/babel" data-presets="react">
    const App = () => {
      const [questions, setQuestions] = React.useState([]);
      const [current, setCurrent] = React.useState(0);
      const [answers, setAnswers] = React.useState({});
      const [submitted, setSubmitted] = React.useState(false);

      // Load questions.json dynamically
      React.useEffect(() => {
        fetch('questions.json?v=' + Date.now())
          .then(res => res.json())
          .then(data => setQuestions(data))
          .catch(err => console.error('Error loading questions:', err));
      }, []);

      if (!questions.length) {
        return <div className="text-center text-lg text-gray-500">Loading questions...</div>;
      }

      const q = questions[current];

      const handleSelect = (opt) => {
        setAnswers({ ...answers, [current]: opt });
      };

      const next = () => current < questions.length - 1 && setCurrent(current + 1);
      const prev = () => current > 0 && setCurrent(current - 1);
      const submit = () => setSubmitted(true);

      const score = Object.entries(answers).reduce(
        (acc, [i, ans]) => acc + (ans === questions[i].answer ? 1 : 0),
        0
      );

      if (submitted) {
        return (
          <div className="max-w-2xl mx-auto p-4">
            <h2 className="text-2xl font-bold text-center mb-4">Your Result</h2>
            <p className="text-center text-lg mb-4">
              Score: {score} / {questions.length} ({Math.round((score / questions.length) * 100)}%)
            </p>
            <div className="space-y-6">
              {questions.map((q, i) => {
                const sel = answers[i];
                const correct = sel === q.answer;
                return (
                  <div key={i} className="border p-4 rounded-lg shadow-sm">
                    <p className="font-semibold">{i + 1}. {q.question}</p>
                    <p className={`mt-2 ${correct ? 'text-green-600' : 'text-red-600'}`}>
                      Your answer: {sel || 'Not answered'}
                    </p>
                    <p className="text-green-700">Correct: {q.answer}</p>
                    <p className="text-gray-600 text-sm mt-1">{q.explanation}</p>
                  </div>
                );
              })}
            </div>
            <div className="text-center mt-6">
              <button
                onClick={() => { setSubmitted(false); setAnswers({}); setCurrent(0); }}
                className="bg-primary text-white px-6 py-2 rounded-lg"
              >
                Retry Test
              </button>
            </div>
          </div>
        );
      }

      return (
        <div className="max-w-xl mx-auto bg-white rounded-xl shadow-lg p-6">
          <h2 className="text-lg font-semibold mb-2 text-primary">
            Question {current + 1} of {questions.length}
          </h2>
          <p className="mb-4">{q.question}</p>
          <div className="space-y-2">
            {q.options.map((opt, i) => (
              <label key={i} className="block border rounded-lg px-3 py-2 cursor-pointer hover:bg-blue-50">
                <input
                  type="radio"
                  name={`q${current}`}
                  checked={answers[current] === opt}
                  onChange={() => handleSelect(opt)}
                  className="mr-2"
                />
                {opt}
              </label>
            ))}
          </div>
          <div className="flex justify-between mt-6">
            <button onClick={prev} disabled={current === 0}
              className="bg-gray-300 px-4 py-2 rounded-lg disabled:opacity-50">Previous</button>
            {current < questions.length - 1 ? (
              <button onClick={next} className="bg-primary text-white px-4 py-2 rounded-lg">Next</button>
            ) : (
              <button onClick={submit} className="bg-green-600 text-white px-4 py-2 rounded-lg">Submit</button>
            )}
          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
